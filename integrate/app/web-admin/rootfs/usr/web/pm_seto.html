<script language="JavaScript">
function callColorDlg(sInitColor)
{
	if (sInitColor == null) 
		var sColor = dlgHelper.ChooseColorDlg();
	else 
		var sColor = dlgHelper.ChooseColorDlg(sInitColor);
	sColor = sColor.toString(16);
	if (sColor.length < 6) {
		var sTempString = "000000".substring(0, 6 - sColor.length);
		sColor = sTempString.concat(sColor);
	}
	sColor = "#".concat(sColor).toUpperCase();
	return sColor;
}
function color(initcolor)
{
	var cmdurl;	
	var date=new Date().getMilliseconds();
	//alert(initcolor);
	if(navigator.appName.indexOf("Microsoft Internet Explorer") != -1)
	{
		var ret  =  callColorDlg(initcolor);
		document.getElementById('pm_color').style.backgroundColor=ret;	
		change_color(ret);
	}
	else
	{
		$('.color-box').click();

	}
//alert(cmdurl);
}
function image_init_pm()
{
	document.getElementById('pm_enable').checked=pm_enable_g;
	//document.getElementById('pm_color').style.backgroundColor=pm_color_g;
	$("#pm_color").css("background-color", pm_color_g); 		
}
function get_background()
{
	var url="/back_pic.jpg?"+"time="+new Date().toString();
	document.getElementById("background_pic").src=url;
}	
</script>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Expires" content="now">
		<meta http-equiv="Pragma" content="no-cache">
		<link rel="stylesheet" href="/include/jquery-ui.min.css">	
		<script language="javascript" src="/include/jquery-1.10.2.min.js"> </script>
		<script language="javascript" src="/include/jquery-ui.min.js"> </script>
		<script src="/include/js/colpick.js" type="text/javascript"></script>
		<link rel="stylesheet" href="/colpick.css" type="text/css"/>	
		<script src="/include/help.js"> </script>
		<script src="/include/pm_area.js"> </script>
		<link href="/pm.css" rel=stylesheet type=text/css>
<script type='text/javascript'>
$(function(){
	$('.color-box').colpick({
		colorScheme:'dark',
		layout:'rgbhex',
		color:pm_color_g,
		onSubmit:function(hsb,hex,rgb,el) {
			$('#pm_color').css('background-color', '#'+hex);
			//alert($('#pm_color').css('background-color'));
			$(el).colpickHide();
			var ret = $('#pm_color').css('background-color').colorHex();	
			//alert("ret="+ret);	
			change_color(ret);
		}
	});
});	
</script>		
	</head>
	<body  onload="pm_init()">
		<center>
			<iframe id="hiddenframe_image" width="0" height="0" src="" style="display:none">
				</iframe>
			<div style="display:block;position:absolute;top:5px;left:150px;">
			<table border=0 cellPadding=0 cellSpacing=0 width=502>
				<tbody>
					<tr>
						<td align=left class=titlenone width=495>
							<script type='text/javascript'>document.write(PM_TITLE);</script>
						</td>
					</tr>
					<tr>
						<td colSpan=2>
							<table border=0 cellPadding=0 cellSpacing=0 className="t_table" width=502>
								<tbody>
									<tr>
										<td class=vline rowSpan=15><br></td>
										<td width=500><table border="0" align="center" cellpadding="0" cellspacing="5"  class=space width=400>
									<tr>
										<td colspan=2 align="center"><img id="background_pic" src="/back_pic.jpg" border="0" width="400px" height="300px"></td>
										</tr>
									<tr>
										<td colspan=2 align="center">
											<input type="button" id="btn_select_all" value="Select All" style="width:70px" onclick="selectAll();"><script type='text/javascript'>document.getElementById('btn_select_all').value=PM_Select_All;</script>
											<input type="button" id="btn_clean_all" value="Clean All"  style="width:70px" onclick="selectNone();"><script type='text/javascript'>document.getElementById('btn_clean_all').value=PM_Clean_All;</script>
											<input type="button" id="btn_reset" value="Reset"  style="width:70px" onclick="reset();"><script type='text/javascript'>document.getElementById('btn_reset').value=PM_Reset;</script>
										</td>
									</tr>
									<tr><td colspan=2 align="left"><strong><script type='text/javascript'>document.write(PM_Note);</script></strong><script type='text/javascript'>document.write(PM_Note_message);</script> 
										</td>
									</tr>
<tr><td><script type='text/javascript'>document.write(PM_Enable);</script>
</td><td>
<input type="checkbox" id="pm_enable"></td></tr>
	<tr><td><script type='text/javascript'>document.write(PM_COLOR);</script><OBJECT id="dlgHelper" CLASSID="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px"></OBJECT>
</td><td>
<input style="width:35px" type="button" id="pm_color" name="pm_color" class="button_color" value="" onclick="color($('#pm_color').css('background-color').colorHex());">
<input type="button" class="color-box" style="visibility:hidden;width:1px;height:1px;padding:0px;margin:0px">
		</td>
	</tr>
<tr><td colspan=2 align="center"><hr></td></tr>
<tr><td colspan=2 align="center">
	<input type="button" id="btn_save" value="Save" style="width:70px" onclick="submit_pm()"><script type='text/javascript'>document.getElementById('btn_save').value=PM_Save;</script>
	
	</td>
	</tr>
</table></td><td class=vline rowSpan=15><br></td></tr><tr><td class=hline></td></tr></tbody></table></td></tr></tbody></table></div><div style="display:block;position:absolute;top:9px;left:150px;"><table border=0 cellPadding=0 cellSpacing=0 width=502><tbody><tr><td align=left class=title width=495><script type='text/javascript'>document.write(PM_TITLE);</script></td></tr><tr><td colSpan=2><table border=0 cellPadding=0 cellSpacing=0 className="t_table" width=502><tbody><tr><td class=vline rowSpan=15><br></td><td width=500><table border="0" align="center" cellpadding="0" cellspacing="0" class=space width=400><tr><td colspan=2 align="center">

<tr>
<td id="1" onmousemove="visible(this.id)" class="block"></td><td id="2" onmousemove="visible(this.id)" class="block"></td><td id="3" onmousemove="visible(this.id)" class="block"></td><td id="4" onmousemove="visible(this.id)" class="block"></td><td id="5" onmousemove="visible(this.id)" class="block"></td><td id="6" onmousemove="visible(this.id)" class="block"></td><td id="7" onmousemove="visible(this.id)" class="block"></td><td id="8" onmousemove="visible(this.id)" class="block"></td><td id="9" onmousemove="visible(this.id)" class="block"></td><td id="10" onmousemove="visible(this.id)" class="block"></td><td id="11" onmousemove="visible(this.id)" class="block"></td><td id="12" onmousemove="visible(this.id)" class="block"></td><td id="13" onmousemove="visible(this.id)" class="block"></td><td id="14" onmousemove="visible(this.id)" class="block"></td><td id="15" onmousemove="visible(this.id)" class="block"></td><td id="16" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="17" onmousemove="visible(this.id)" class="block"></td><td id="18" onmousemove="visible(this.id)" class="block"></td><td id="19" onmousemove="visible(this.id)" class="block"></td><td id="20" onmousemove="visible(this.id)" class="block"></td><td id="21" onmousemove="visible(this.id)" class="block"></td><td id="22" onmousemove="visible(this.id)" class="block"></td><td id="23" onmousemove="visible(this.id)" class="block"></td><td id="24" onmousemove="visible(this.id)" class="block"></td><td id="25" onmousemove="visible(this.id)" class="block"></td><td id="26" onmousemove="visible(this.id)" class="block"></td><td id="27" onmousemove="visible(this.id)" class="block"></td><td id="28" onmousemove="visible(this.id)" class="block"></td><td id="29" onmousemove="visible(this.id)" class="block"></td><td id="30" onmousemove="visible(this.id)" class="block"></td><td id="31" onmousemove="visible(this.id)" class="block"></td><td id="32" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="33" onmousemove="visible(this.id)" class="block"></td><td id="34" onmousemove="visible(this.id)" class="block"></td><td id="35" onmousemove="visible(this.id)" class="block"></td><td id="36" onmousemove="visible(this.id)" class="block"></td><td id="37" onmousemove="visible(this.id)" class="block"></td><td id="38" onmousemove="visible(this.id)" class="block"></td><td id="39" onmousemove="visible(this.id)" class="block"></td><td id="40" onmousemove="visible(this.id)" class="block"></td><td id="41" onmousemove="visible(this.id)" class="block"></td><td id="42" onmousemove="visible(this.id)" class="block"></td><td id="43" onmousemove="visible(this.id)" class="block"></td><td id="44" onmousemove="visible(this.id)" class="block"></td><td id="45" onmousemove="visible(this.id)" class="block"></td><td id="46" onmousemove="visible(this.id)" class="block"></td><td id="47" onmousemove="visible(this.id)" class="block"></td><td id="48" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="49" onmousemove="visible(this.id)" class="block"></td><td id="50" onmousemove="visible(this.id)" class="block"></td><td id="51" onmousemove="visible(this.id)" class="block"></td><td id="52" onmousemove="visible(this.id)" class="block"></td><td id="53" onmousemove="visible(this.id)" class="block"></td><td id="54" onmousemove="visible(this.id)" class="block"></td><td id="55" onmousemove="visible(this.id)" class="block"></td><td id="56" onmousemove="visible(this.id)" class="block"></td><td id="57" onmousemove="visible(this.id)" class="block"></td><td id="58" onmousemove="visible(this.id)" class="block"></td><td id="59" onmousemove="visible(this.id)" class="block"></td><td id="60" onmousemove="visible(this.id)" class="block"></td><td id="61" onmousemove="visible(this.id)" class="block"></td><td id="62" onmousemove="visible(this.id)" class="block"></td><td id="63" onmousemove="visible(this.id)" class="block"></td><td id="64" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="65" onmousemove="visible(this.id)" class="block"></td><td id="66" onmousemove="visible(this.id)" class="block"></td><td id="67" onmousemove="visible(this.id)" class="block"></td><td id="68" onmousemove="visible(this.id)" class="block"></td><td id="69" onmousemove="visible(this.id)" class="block"></td><td id="70" onmousemove="visible(this.id)" class="block"></td><td id="71" onmousemove="visible(this.id)" class="block"></td><td id="72" onmousemove="visible(this.id)" class="block"></td><td id="73" onmousemove="visible(this.id)" class="block"></td><td id="74" onmousemove="visible(this.id)" class="block"></td><td id="75" onmousemove="visible(this.id)" class="block"></td><td id="76" onmousemove="visible(this.id)" class="block"></td><td id="77" onmousemove="visible(this.id)" class="block"></td><td id="78" onmousemove="visible(this.id)" class="block"></td><td id="79" onmousemove="visible(this.id)" class="block"></td><td id="80" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="81" onmousemove="visible(this.id)" class="block"></td><td id="82" onmousemove="visible(this.id)" class="block"></td><td id="83" onmousemove="visible(this.id)" class="block"></td><td id="84" onmousemove="visible(this.id)" class="block"></td><td id="85" onmousemove="visible(this.id)" class="block"></td><td id="86" onmousemove="visible(this.id)" class="block"></td><td id="87" onmousemove="visible(this.id)" class="block"></td><td id="88" onmousemove="visible(this.id)" class="block"></td><td id="89" onmousemove="visible(this.id)" class="block"></td><td id="90" onmousemove="visible(this.id)" class="block"></td><td id="91" onmousemove="visible(this.id)" class="block"></td><td id="92" onmousemove="visible(this.id)" class="block"></td><td id="93" onmousemove="visible(this.id)" class="block"></td><td id="94" onmousemove="visible(this.id)" class="block"></td><td id="95" onmousemove="visible(this.id)" class="block"></td><td id="96" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="97" onmousemove="visible(this.id)" class="block"></td><td id="98" onmousemove="visible(this.id)" class="block"></td><td id="99" onmousemove="visible(this.id)" class="block"></td><td id="100" onmousemove="visible(this.id)" class="block"></td><td id="101" onmousemove="visible(this.id)" class="block"></td><td id="102" onmousemove="visible(this.id)" class="block"></td><td id="103" onmousemove="visible(this.id)" class="block"></td><td id="104" onmousemove="visible(this.id)" class="block"></td><td id="105" onmousemove="visible(this.id)" class="block"></td><td id="106" onmousemove="visible(this.id)" class="block"></td><td id="107" onmousemove="visible(this.id)" class="block"></td><td id="108" onmousemove="visible(this.id)" class="block"></td><td id="109" onmousemove="visible(this.id)" class="block"></td><td id="110" onmousemove="visible(this.id)" class="block"></td><td id="111" onmousemove="visible(this.id)" class="block"></td><td id="112" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="113" onmousemove="visible(this.id)" class="block"></td><td id="114" onmousemove="visible(this.id)" class="block"></td><td id="115" onmousemove="visible(this.id)" class="block"></td><td id="116" onmousemove="visible(this.id)" class="block"></td><td id="117" onmousemove="visible(this.id)" class="block"></td><td id="118" onmousemove="visible(this.id)" class="block"></td><td id="119" onmousemove="visible(this.id)" class="block"></td><td id="120" onmousemove="visible(this.id)" class="block"></td><td id="121" onmousemove="visible(this.id)" class="block"></td><td id="122" onmousemove="visible(this.id)" class="block"></td><td id="123" onmousemove="visible(this.id)" class="block"></td><td id="124" onmousemove="visible(this.id)" class="block"></td><td id="125" onmousemove="visible(this.id)" class="block"></td><td id="126" onmousemove="visible(this.id)" class="block"></td><td id="127" onmousemove="visible(this.id)" class="block"></td><td id="128" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="129" onmousemove="visible(this.id)" class="block"></td><td id="130" onmousemove="visible(this.id)" class="block"></td><td id="131" onmousemove="visible(this.id)" class="block"></td><td id="132" onmousemove="visible(this.id)" class="block"></td><td id="133" onmousemove="visible(this.id)" class="block"></td><td id="134" onmousemove="visible(this.id)" class="block"></td><td id="135" onmousemove="visible(this.id)" class="block"></td><td id="136" onmousemove="visible(this.id)" class="block"></td><td id="137" onmousemove="visible(this.id)" class="block"></td><td id="138" onmousemove="visible(this.id)" class="block"></td><td id="139" onmousemove="visible(this.id)" class="block"></td><td id="140" onmousemove="visible(this.id)" class="block"></td><td id="141" onmousemove="visible(this.id)" class="block"></td><td id="142" onmousemove="visible(this.id)" class="block"></td><td id="143" onmousemove="visible(this.id)" class="block"></td><td id="144" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="145" onmousemove="visible(this.id)" class="block"></td><td id="146" onmousemove="visible(this.id)" class="block"></td><td id="147" onmousemove="visible(this.id)" class="block"></td><td id="148" onmousemove="visible(this.id)" class="block"></td><td id="149" onmousemove="visible(this.id)" class="block"></td><td id="150" onmousemove="visible(this.id)" class="block"></td><td id="151" onmousemove="visible(this.id)" class="block"></td><td id="152" onmousemove="visible(this.id)" class="block"></td><td id="153" onmousemove="visible(this.id)" class="block"></td><td id="154" onmousemove="visible(this.id)" class="block"></td><td id="155" onmousemove="visible(this.id)" class="block"></td><td id="156" onmousemove="visible(this.id)" class="block"></td><td id="157" onmousemove="visible(this.id)" class="block"></td><td id="158" onmousemove="visible(this.id)" class="block"></td><td id="159" onmousemove="visible(this.id)" class="block"></td><td id="160" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="161" onmousemove="visible(this.id)" class="block"></td><td id="162" onmousemove="visible(this.id)" class="block"></td><td id="163" onmousemove="visible(this.id)" class="block"></td><td id="164" onmousemove="visible(this.id)" class="block"></td><td id="165" onmousemove="visible(this.id)" class="block"></td><td id="166" onmousemove="visible(this.id)" class="block"></td><td id="167" onmousemove="visible(this.id)" class="block"></td><td id="168" onmousemove="visible(this.id)" class="block"></td><td id="169" onmousemove="visible(this.id)" class="block"></td><td id="170" onmousemove="visible(this.id)" class="block"></td><td id="171" onmousemove="visible(this.id)" class="block"></td><td id="172" onmousemove="visible(this.id)" class="block"></td><td id="173" onmousemove="visible(this.id)" class="block"></td><td id="174" onmousemove="visible(this.id)" class="block"></td><td id="175" onmousemove="visible(this.id)" class="block"></td><td id="176" onmousemove="visible(this.id)" class="block"></td>
</tr>
<tr>
<td id="177" onmousemove="visible(this.id)" class="block"></td><td id="178" onmousemove="visible(this.id)" class="block"></td><td id="179" onmousemove="visible(this.id)" class="block"></td><td id="180" onmousemove="visible(this.id)" class="block"></td><td id="181" onmousemove="visible(this.id)" class="block"></td><td id="182" onmousemove="visible(this.id)" class="block"></td><td id="183" onmousemove="visible(this.id)" class="block"></td><td id="184" onmousemove="visible(this.id)" class="block"></td><td id="185" onmousemove="visible(this.id)" class="block"></td><td id="186" onmousemove="visible(this.id)" class="block"></td><td id="187" onmousemove="visible(this.id)" class="block" </td><td id="188" onmousemove="visible(this.id)" class="block"></td><td id="189" onmousemove="visible(this.id)" class="block"></td><td id="190" onmousemove="visible(this.id)" class="block"></td><td id="191" onmousemove="visible(this.id)" class="block"></td><td id="192" onmousemove="visible(this.id)" class="block"></td>
</tr>
</table>
</td><td class-vline rowSpan=15><br></td></tr><tr><td></td></tr></tbody></table></td></tr></tbody></table></div></center></body></html>
 

