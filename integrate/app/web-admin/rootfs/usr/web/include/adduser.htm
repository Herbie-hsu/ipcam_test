




<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><TITLE>Add User</TITLE>
<META HTTP-EQUIV="Expires" CONTENT="now"><META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<SCRIPT SRC="/include/help.js"></SCRIPT>
<LINK href="/nb.css" rel=stylesheet type=text/css>
<!-- GLOBAL JAVASCRIPTS -->

</head>
<body class="bodyBg" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" bgcolor="white" onLoad="window.focus();focusOnFirst()">

<script language="JavaScript">
<!--

function initControls()
{
  var aForm = document.useraddForm;
  var myOriginalName = "";
  var myOriginalGroup = "view";
  var ptzUser = [];
  var form = document.useraddForm;
   
  if (myOriginalName != "root") {
    if (myOriginalName.length > 0) {

      if (myOriginalGroup.toLowerCase().charAt(0) == "a")
        aForm.sgrp[2].checked = true;
      else if (myOriginalGroup.toLowerCase().charAt(0) == "o")
        aForm.sgrp[1].checked = true;

      else
        aForm.sgrp[0].checked = true;
    } else {
      aForm.sgrp[0].checked = true;
    }
  }
  

}

function focusOnFirst()
{
  var form = document.useraddForm;
  form.user.focus()
  form.user.select()
}

function checkUserName()
{
  var form = document.useraddForm;
  var aName = form.user.value;
  var c;
 // var currentUsers=[];
   var userList = window.opener.document.forms[0].elements[0];
  // Check empty username
  if (aName.charAt(0) == '') {
    alert("A user name must contain at least one character.")
    form.user.focus()
    form.user.select()
    return false
  }
	
  // Check for too long username
 
  if (aName.length > 14) {
    alert("Max 14 characters are allowed in user names.")
    form.user.focus()
    form.user.select()
    return false
  }

  // Check invalid characters
  c = aName.charAt(0)
  if (!((c>='A' && c<='Z') || (c>='a' && c<='z'))) {
    alert("The first character in user name must be A-Z or a-z.")
    form.user.focus()
    form.user.select()
    return false
  }

  for (var i = 0; i < aName.length; i++) {
    c = aName.charAt(i)
    if (!((c>='A' && c<='Z') || (c>='a' && c<='z') || (c>='0' && c<='9') || (c =='_'))) {
      alert("Only A-Z, a-z, _ and 0-9 are allowed in the user name.")
      form.user.focus()
      form.user.select()
      return false
    }
  }

 for(var i = 0; i < userList.length; i++)
 {
 
 	if(userList.options[i].value.toLowerCase() == aName.toLowerCase())
 	{
		alert("A user with that name already exists");
		return false;
 	}
 }
  return true
}


function checkPassword()
{
  var form = document.useraddForm
  var aPass1 = form.pwd.value
  var aPass2 = form.pwd_confirm.value
  var c

  // Check short password
  if (aPass1.length < 1) {
    alert("The password must contain at least one character.")
    form.pwd.focus()
    form.pwd.select()
    return false
  }
  
  // Check for too long password
  if (aPass1.length > 8) {
    alert("Max eight characters are allowed in the password.")
    form.pwd.focus()
    form.pwd.select()
    return false
  }

  // Check that the real password is same as the confirm password.
  if (aPass1 != aPass2) {
    alert("The 'Password' and 'Confirm password' do not match. Please enter again.")
    form.pwd.focus()
    form.pwd.select()
    return false
  }
 
  return true
}


function saveData()
{
  var action = "add";
  var originalUser = "";
  var submitForm = document.submitForm;
  var userForm = document.useraddForm;
  var userNum = window.opener.document.forms[0].elements[0].length;
  
  if (action == "add" && !checkUserName()) {
     	return false;
  }
  if (!checkPassword()) {
     return false;
  }

  // Build submitstring
  submitForm.action.value = action;
	submitForm.op.value = "user";
  submitForm.user.value = userForm.user.value;// + ":";
  if (originalUser != "root") {
    for (i = 0 ; i < 3 ; i++) {
       if (userForm.sgrp[i].checked) {
         submitForm.sgrp.value = userForm.sgrp[i].value;
         break;
       }
    }

  }
  
  if (userForm.pwd.value.length > 0) {
   	submitForm.pwd.value = escape(userForm.pwd.value);
  }
  if(userNum > 9)
  	alert("At most 10 users");
  else
  	submitForm.submit();
  return false;  
}
// -->
</script>

<form name="useraddForm"  onSubmit="javascript: return saveData();">
<TABLE border="1" cellpadding="0" align="center" cellspacing="0"  class="evenItem"  width="350" height="300">
  <tr><td>
  <TABLE border="0" cellpadding="0" cellspacing="0" align="center" class="oddItem" width="300">
    <tr>
    </tr>
    <tr><td class="oddItem">Name</td><td nowrap class="oddItem"><input type="text" class="fieldName" style="width:120px" maxlength="14" name="user"></td>
    </tr>
    <tr><td class="evenItem">Password</td><td class="evenItem"><input type="password" class="fieldName" style="width:120px" maxlength="8" name="pwd"></td></tr>
    <tr><td nowrap class="oddItem">Confirm Password</td><td class="oddItem"><input type="password" class="fieldName" style="width:120px" maxlength="8" name="pwd_confirm"></td></tr>

    <tr><td valign="top" class="evenItem">Groups</td>
        <td class="evenItem"><input type="radio" name="sgrp" value="snxview">Viewer<br>
            <input type="radio" name="sgrp" value="snxadmin:snxoper:snxview">Administrator
        </td></tr>


    <tr>
      <td class="topTitle" align="center" colspan="2">
        <TABLE border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td class="button"><input type="button" style="width:60px" value="OK" class="btnNormal" onClick="JavaScript:saveData()"></td>
            <td class="button">&nbsp;</td>
            <td class="button"><input type="button" style="width:60px" value="Cancel" class="btnNormal" onClick="window.close()"></td>
          </tr>
        </TABLE>   
      </td>
    </tr>
  </TABLE>
  </td></tr>
</TABLE>
</form>

<form name="submitForm" action="/cgi-bin/system/sysconf.cgi" method="post">
<input type="hidden" name="user" value="">
<input type="hidden" name="action" value="">
<input type="hidden" name="pwd" value="">
<input type="hidden" name="sgrp" value="">
<input type="hidden" name="op" value="">
</form>


<script language="JavaScript">
<!--
initControls();
// -->
</script>

</body>
</html>
